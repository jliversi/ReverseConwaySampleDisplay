(()=>{"use strict";const t=[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],e={arrows:JSON.parse("[[0,0,0,0,0,0,0],[0,0,1,1,0,0,0],[0,0,1,0,1,1,1],[1,0,1,0,0,0,1],[0,0,0,0,0,0,0],[0,0,0,0,1,1,1],[0,0,1,0,0,0,1],[0,1,0,1,0,1,0],[1,0,0,1,1,1,1],[1,0,1,1,0,1,0],[1,0,0,0,0,1,0],[0,0,0,0,0,1,0],[0,0,1,1,1,0,0],[0,1,0,1,0,1,0],[1,0,0,0,0,0,0],[0,1,1,1,1,0,1],[1,0,1,0,1,0,1],[1,0,0,1,0,1,0],[0,1,1,0,1,1,0],[1,0,0,0,0,0,0],[1,1,0,0,1,0,0],[0,0,1,1,0,1,0],[0,0,1,1,1,0,1],[0,1,1,1,0,0,1],[0,1,0,0,1,0,0],[0,0,1,0,1,0,0],[0,0,0,1,0,0,1]]"),car:JSON.parse("[[0,1,1,1,1,1,0],[0,1,0,0,0,1,1],[0,0,1,1,0,0,0],[0,0,1,1,1,0,0],[1,0,0,1,0,0,0],[0,1,0,0,0,0,1],[1,0,1,0,0,1,0],[1,0,0,0,1,1,0],[1,1,1,0,1,0,0],[0,0,0,0,1,0,1],[0,0,1,1,0,0,1],[0,0,0,1,1,1,0],[1,1,0,0,0,1,0],[0,0,1,1,0,0,0],[0,1,0,0,0,0,1],[0,1,0,0,1,1,1],[0,0,0,0,0,1,0],[0,0,1,1,1,1,0],[0,0,0,0,1,1,0],[1,1,0,0,1,0,0],[0,0,1,1,0,1,1],[1,0,1,0,0,1,0],[0,1,0,0,1,0,1],[0,1,0,0,0,1,0],[0,1,0,1,0,0,1],[1,0,0,1,1,0,1],[0,0,1,0,1,0,0]]"),conway:JSON.parse("[[0,1,1,0,1,0,1],[0,1,0,0,1,1,0],[1,1,0,0,0,1,0],[1,1,0,0,0,0,1],[0,0,0,1,0,0,1],[0,1,1,0,0,1,1],[1,0,1,0,0,1,1],[0,0,0,0,0,1,1],[1,0,1,0,1,0,0],[0,0,1,0,1,1,0],[0,0,0,0,0,0,0],[0,0,1,1,0,1,0],[0,1,1,0,0,0,1],[1,0,1,0,0,0,0],[0,0,0,1,1,0,0],[1,0,0,0,0,1,1],[0,0,1,0,0,0,0],[1,0,0,0,0,1,0],[0,0,1,1,0,1,1],[0,0,0,0,0,1,1],[0,0,0,1,1,1,1],[0,0,1,0,0,0,0],[1,0,1,0,0,1,0],[0,0,1,0,0,1,0],[0,1,0,1,1,0,1],[1,1,0,0,0,1,1],[1,1,0,0,0,0,0]]"),game:JSON.parse("[[1,0,0,1,1,0,0],[1,0,0,0,1,0,1],[0,0,1,0,1,1,0],[0,0,1,1,0,1,0],[0,1,1,0,0,1,0],[1,0,1,0,1,0,1],[0,0,0,0,0,0,1],[0,1,0,1,1,0,0],[0,1,0,1,1,0,0],[0,0,0,0,1,0,1],[0,1,1,0,1,0,0],[0,0,0,0,0,0,0],[0,1,0,0,1,0,0],[1,0,1,0,0,0,1],[1,0,0,1,0,0,1],[0,0,1,1,0,0,1],[0,0,0,0,0,0,1],[0,0,1,1,1,0,1],[1,0,1,0,0,0,1],[0,0,1,1,0,0,1],[1,1,0,1,0,1,0],[0,1,0,1,1,1,1],[0,0,0,1,0,0,1],[0,0,0,0,0,0,1],[0,1,0,1,0,0,1],[0,1,0,1,0,1,1],[0,1,0,1,0,0,0]]"),of_life:JSON.parse("[[0,1,1,0,1,1,0],[1,0,0,0,0,1,1],[1,1,0,0,0,0,1],[0,0,0,0,0,1,0],[0,1,0,1,0,1,0],[1,0,0,0,1,1,0],[0,0,0,0,1,0,0],[0,0,0,0,0,0,1],[1,1,1,0,1,0,0],[1,0,0,0,1,1,1],[0,0,0,1,0,0,1],[1,0,0,1,0,0,0],[0,1,1,1,1,1,0],[0,1,0,0,0,0,0],[1,1,0,1,0,0,0],[1,1,0,0,0,1,0],[0,0,0,1,1,0,1],[0,0,1,1,1,1,0],[1,0,1,0,0,0,0],[0,1,0,0,1,1,0],[1,0,1,0,0,0,0],[0,0,1,1,1,1,0],[0,1,1,1,1,0,0],[0,1,0,1,0,1,0],[0,0,0,0,0,1,1],[0,0,1,0,1,0,0],[0,1,1,1,1,0,0]]"),python:JSON.parse("[[0,1,0,1,1,0,1],[0,0,0,0,0,0,0],[1,0,1,1,1,1,0],[0,0,1,1,1,0,0],[0,1,0,0,1,0,1],[0,0,0,0,0,1,0],[0,0,1,0,1,1,1],[1,1,1,1,0,0,0],[0,1,0,0,1,0,1],[0,0,1,1,0,1,0],[0,1,1,1,0,0,1],[1,0,0,0,1,0,1],[0,0,1,0,1,0,1],[1,0,0,0,0,0,1],[1,1,1,0,1,0,0],[0,0,1,1,0,0,0],[0,0,1,1,0,0,1],[1,0,0,0,0,0,0],[1,0,1,1,1,0,1],[1,1,0,1,1,1,0],[0,0,1,0,0,0,0],[0,1,0,0,0,0,1],[1,1,0,0,0,1,0],[1,0,0,1,0,1,0],[1,0,0,0,0,1,0],[0,1,1,0,0,0,0],[0,0,0,1,0,0,1]]"),space_invader:JSON.parse("[[0,0,0,1,0,0,0],[0,0,0,0,0,1,0],[0,0,1,1,1,0,0],[1,0,0,0,1,1,1],[0,1,0,0,0,0,1],[0,1,0,0,0,1,1],[0,1,1,1,0,1,1],[1,0,1,0,1,0,0],[0,0,0,0,1,0,0],[1,1,1,1,1,1,0],[1,0,1,0,0,0,1],[1,0,0,0,0,1,0],[0,1,1,0,1,1,0],[0,0,0,0,0,1,0],[1,1,0,1,1,1,0],[0,1,0,1,0,1,0],[0,1,1,1,0,0,1],[0,0,1,1,1,0,0],[0,0,0,0,0,1,1],[0,1,1,1,1,0,1],[0,0,0,0,0,1,1],[1,1,0,0,0,0,0],[0,1,1,0,1,0,0],[0,0,0,1,1,0,1],[0,1,0,1,0,0,1],[0,0,0,1,0,0,1],[1,0,0,0,0,0,0]]")},s=t=>{const e=[];for(let s=t[0].length-1;s>=0;s--){const r=[];e.push(r);for(let e=0;e<t.length;e++)r.push(t[e][s])}return e},r=s(e.conway),{x:n,y:i}={x:r[0].length,y:r.length},o=new class{constructor(t,e,s,r){this.DIM_X=t,this.DIM_Y=e,this.ele=s,this.speed=1e3,this.buildBoard(r),this.setupListeners(),this.changeSpeed=this.changeSpeed.bind(this)}buildBoard(t){const e=this.ele;this.eleArr=[];for(let t=0;t<this.DIM_Y;t++){const s=document.createElement("tr"),r=[];s.id=t,s.classList.add("row");for(let e=0;e<this.DIM_X;e++){const n=document.createElement("td");n.id=`${e},${t}`,n.classList.add("cell"),s.appendChild(n),r.push(n)}e.appendChild(s),this.eleArr.push(r)}this.setupBoard(t),this.render()}setupBoard(t){this.board=t.map((t=>t.map((t=>!!t))))}setupListeners(){for(let t=0;t<this.eleArr.length;t++)for(let e=0;e<this.eleArr[0].length;e++){const s=this.eleArr[t][e],r=r=>{this.board[t]&&this.board[t][e]?(this.board[t][e]=!1,s.classList.add("off"),s.classList.remove("on")):(this.board[t][e]=!0,s.classList.add("on"),s.classList.remove("off"))};s.addEventListener("mousedown",r);const n=r=>{1!=r.buttons&&3!=r.buttons||(this.board[t]&&this.board[t][e]?(this.board[t][e]=!1,s.classList.add("off"),s.classList.remove("on")):(this.board[t][e]=!0,s.classList.add("on"),s.classList.remove("off")))};s.addEventListener("mouseover",n)}}neighborCoords(e,s){const r=t.map((([t,r])=>[e+t,s+r]));for(let t=0;t<r.length;t++){const e=r[t];e[0]==this.DIM_X?e[0]=0:e[0]<0&&(e[0]=this.DIM_X-1),e[1]==this.DIM_Y?e[1]=0:e[1]<0&&(e[1]=this.DIM_Y-1)}return r}numOnNeighbors(t,e){const s=this.neighborCoords(t,e);let r=0;for(let t=0;t<s.length;t++){const[e,n]=s[t];this.board[n]&&this.board[n][e]&&(r+=1)}return r}runRound(){const t=[],e=[];for(let s=0;s<this.board.length;s++)for(let r=0;r<this.board[0].length;r++){const n=this.numOnNeighbors(r,s);this.board[s][r]?(n<2||n>3)&&e.push([s,r]):3===n&&t.push([s,r])}t.forEach((([t,e])=>{this.board[t][e]=!0})),e.forEach((([t,e])=>{this.board[t][e]=!1}))}render(){for(let t=0;t<this.board.length;t++)for(let e=0;e<this.board[0].length;e++){const s=this.eleArr[t][e];this.board[t][e]?(s.classList.add("on"),s.classList.remove("off")):(s.classList.add("off"),s.classList.remove("on"))}}run(){this.running||(this.running=!0,this.intId=setInterval((()=>{this.runRound(),this.render()}),this.speed))}changeSpeed(t){this.speed=t,this.running&&(this.stop(),this.run())}stop(){clearInterval(this.intId),this.running=!1}clearBoard(){this.board=Array.from({length:this.DIM_Y},(()=>Array.from({length:this.DIM_X},(()=>!1)))),this.renderScrollX()}switchPatterns(t){this.stop(),this.board=Array.from({length:this.DIM_Y},(()=>Array.from({length:this.DIM_X},(()=>!1)))),this.renderScrollY(),setTimeout((()=>{this.board=t,this.renderScrollY()}),400)}fancyRun(){this.running||(this.running=!0,this.intId=setInterval((()=>{this.runRound(),this.renderScrollX(20),this.renderScrollY(60)}),this.speed))}toggleAnimation(){this.stop(),this.run=this.fancyRun===this.run?this.basicRun:this.fancyRun,this.run()}renderScrollY(t=20,e=0){setTimeout((()=>{for(let t=0;t<this.board[0].length;t++){const s=this.eleArr[e][t];this.board[e][t]?(s.classList.add("on"),s.classList.remove("off")):(s.classList.add("off"),s.classList.remove("on"))}e+1<this.board.length&&this.renderScrollY(t,e+1)}),t)}renderScrollX(t=10,e=0){setTimeout((()=>{for(let t=0;t<this.board.length;t++){const s=this.eleArr[t][e];this.board[t][e]?(s.classList.add("on"),s.classList.remove("off")):(s.classList.add("off"),s.classList.remove("on"))}e+1<this.board[0].length&&this.renderScrollX(t,e+1)}),t)}}(n,i,document.getElementById("board"),r),d=document.getElementById("start"),a=document.getElementById("stop");d.addEventListener("click",(t=>{d.disabled=!0,a.disabled=!1,o.run()})),a.addEventListener("click",(t=>{a.disabled=!0,d.disabled=!1,o.stop()})),document.getElementById("one-step").addEventListener("click",(t=>{o.running?(o.stop(),o.runRound(),o.renderScrollX(),o.run()):(o.runRound(),o.renderScrollX())})),document.getElementById("clear").addEventListener("click",(t=>{o.stop(),o.clearBoard()})),document.getElementById("export").addEventListener("click",(t=>{navigator.clipboard.writeText(JSON.stringify(s(s(s(o.board.map((t=>t.map((t=>t?1:0))))))))).then((()=>alert("Pattern copied to clipboard as JSON")))})),document.getElementById("speed").addEventListener("change",(t=>{o.changeSpeed(1500-t.target.value)})),document.getElementById("pattern-select").addEventListener("change",(t=>{d.disabled=!1,a.disabled=!0;const r=s(e[t.target.value]);o.switchPatterns(r)}))})();